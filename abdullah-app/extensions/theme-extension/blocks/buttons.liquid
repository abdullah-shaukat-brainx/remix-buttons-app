{% comment %} Testing with a publicly available API {% endcomment %}

{% assign api_url = "https://da69-122-129-85-58.ngrok-free.app/api/buttonsettings" %}

<div id="dataDisplay">
  <p>Loading data...</p>
</div>

<script>
  const fetchData = async () => {
    try {
      const response = await fetch('{{api_url}}', {
        method: 'GET',
        
        // headers:{
        //   'Content-Type': 'application/json',
        // }
      });

      if (!response.ok) {
        throw new Error('Network response was not ok');
      }
      console.log('RESPONSE: ', response)
      const data = await response.json();
      console.log("*", data)
      return data;
    } catch (error) {
      console.error('Error fetching data:', error);
    }
  };

  document.addEventListener('DOMContentLoaded', () => {
    fetchData().then(data => {
      console.log('Fetched data:', data);

    //   const dataDisplay = document.getElementById('dataDisplay');
    //   if (data) {
    //     dataDisplay.innerHTML = `
    //       <h2>Fetched Data</h2>
    //       <p><strong>Title:</strong> ${data.title}</p>
    //       <p><strong>Body:</strong> ${data.body}</p>
    //     `;
    //   } else {
    //     dataDisplay.innerHTML = `<p>No data available.</p>`;
    //   }
    // }).catch(error => {
    //   console.error('Failed to fetch data:', error);
    //   const dataDisplay = document.getElementById('dataDisplay');
    //   dataDisplay.innerHTML = `<p>Error fetching data.</p>`;
    });
  });
</script>

{% schema %}
{
  "name": "Button Status",
  "target":"section",
  "settings": [
    { "type": "product", "id": "product", "label": "Product", "autofill": true }
  ]
}
{% endschema %}
